% !TeX root = ../main.tex

\section{代数与几何的联系}

不加说明的情况下$k$依然指代数闭域.

\subsection{理想与代数集}

这一节我们将讨论仿射空间与射影空间的代数集与多项式环的理想的对应关系.

先考虑仿射空间$\AF^n$的情况, 记$A\coloneq \kk [X_1, \dotsc, X_n]$. 对于多项式环$A$的子集$T$, 我们已经定义了$T$的零点集$Z(T)\subseteq\AF^n$. 同样地, 对于仿射空间的子集$Y$, 我们也可以定义$Y$的\emph{理想}为在$Y$上取值为零的多项式全体, 即$I(Y)\coloneq \{f\in A\vert f(x)=0, \forall x\in Y\}$, $I(Y)$一定是环$A$的理想, 并且如果$Y$为单点集, 则$I(Y)$为极大理想.

\begin{proposition}[{{\parencite[3, Proposition 1.2; 4, Corollary 1.4]{hartshorne_algebraic_1977}}}]\label{prop:affinegaloisconnectionclosedradical}
    设$Y, Y_1, Y_2$为$\AF^n$的子集, $T, T_1, T_2$为$A$的子集, $\ideal{a}$为$A$的理想, 则
    \begin{enumerate}
        \item\label{enum:prop-affine-galois-connection-closed-radical-1} $Z(T)=Z((T))=Z(\sqrt{(T)})$;
        \item\label{enum:prop-affine-galois-connection-closed-radical-2} 如果$T_1\subseteq T_2$, 那么$Z(T_1)\supseteq Z(T_2)$;
        \item\label{enum:prop-affine-galois-connection-closed-radical-3} $I(Y)=I(\overline{Y})$;
        \item\label{enum:prop-affine-galois-connection-closed-radical-4} 如果$Y_1\subseteq Y_2$, 那么$I(Y_1)\supseteq I(Y_2)$;
        \item\label{enum:prop-affine-galois-connection-closed-radical-5} $I(Y_1\cup Y_2)=I(Y_1)\cap I(Y_2)$;
        \item\label{enum:prop-affine-galois-connection-closed-radical-nullstellensatz} (强Hilbert零点定理\parencite[85, Exercise 14]{atiyah_introduction_1969}) $I(Z(\ideal{a}))=\sqrt{a}$;
        \item\label{enum:prop-affine-galois-connection-closed-radical-closure} $Z(I(Y))=\overline{Y}$;
        \item\label{enum:prop-affine-galois-connection-closed-radical-8} 如果$\ideal{p}$是$A$的素理想, 那么$Z(\ideal{p})$是$\AF^n$的不可约闭集;
        \item\label{enum:prop-affine-galois-connection-closed-radical-9} 如果$Y$是$\AF^n$的不可约闭集, 那么$I(Y)$是$A$的素理想.
    \end{enumerate}
    于是由$Z$和$I$, 我们可以建立$\AF^n$的代数集全体与$A$的根理想之间的反序双射, 将$\AF^n$的不可约闭集对应到$A$的素理想.
\end{proposition}

\begin{proof}
    这里我们只证明\ref{enum:prop-affine-galois-connection-closed-radical-nullstellensatz}\ref{enum:prop-affine-galois-connection-closed-radical-closure}\ref{enum:prop-affine-galois-connection-closed-radical-8}和\ref{enum:prop-affine-galois-connection-closed-radical-9}.

    \ref{enum:prop-affine-galois-connection-closed-radical-nullstellensatz} 根据\ref{enum:prop-affine-galois-connection-closed-radical-1}\ref{enum:prop-affine-galois-connection-closed-radical-2}和\ref{enum:prop-affine-galois-connection-closed-radical-4}知$I(Z(\ideal{a}))\supseteq\sqrt{\ideal{a}}$. 反过来, 假设$f\notin\sqrt{\ideal{a}}$, 根据\thref{prop:scheinnullstellensatz}知存在包含$\ideal{a}$的素理想$\ideal{p}$使得$f\notin\ideal{p}$. 设$B=(A{\divslash}\ideal{p})$, $C=B_{f}=B[1{\divslash}f]$, 则$C$为有限生成$\kk$-代数. 设$\ideal{m}$为$C$的一个极大理想, 则根据\thref{thm:hilbert-nullstellensatz-weak}知$D\coloneq C{\divslash}\ideal{m}\cong\kk$. 设$X_j\in A$在$D$的像为$x_j$, 则我们定义了一个点$x=(x_1, \dotsc, x_n)\in \AF^n$, 并且有$g\in A$在$D$的像为在$g(x)$. 于是我们有$x\in Z(\ideal{a})$但是$f(x)\neq 0$.

    \ref{enum:prop-affine-galois-connection-closed-radical-closure} 根据定义有$Y\subseteq Z(I(Y))$, 而右边是闭集, 所以有$\overline{Y}\subseteq Z(I(Y))$. 反过来, 假设$W$为包含$Y$的闭子集, 则存在$A$的理想$\ideal{a}$使$W=Z(\ideal{a})$. 因此$Z(\ideal{a})\supseteq Y$, 再根据\ref{enum:prop-affine-galois-connection-closed-radical-3}得$I(Z(\ideal{a}))\subseteq I(Y)$. 又$\ideal{a}\subseteq I(Z(\ideal{a}))$, 因此由\ref{enum:prop-affine-galois-connection-closed-radical-2}有$W=Z(\ideal{a})\supseteq Z(I(Y))$. 故$Z(I(Y))=\overline{Y}$.

    \ref{enum:prop-affine-galois-connection-closed-radical-8} 设有闭集$Y_1$和$Y_2$使得$Z(\ideal{p})=Y_1\cup Y_2$, 则由\ref{enum:prop-affine-galois-connection-closed-radical-4}和\ref{enum:prop-affine-galois-connection-closed-radical-nullstellensatz}知$\ideal{p}=I(Y_1)\cap I(Y_2)$, 由\thref{prop:prime}\ref{enum:prop-prime-absorb}知$\ideal{p}=I(Y_1)$或者$\ideal{p}=I(Y_2)$, 故由\ref{enum:prop-affine-galois-connection-closed-radical-closure}得$Z(\ideal{p})=Y_1$或$Z(\ideal{p})=Y_2$, 这就证明了$Z(\ideal{p})$是不可约集.

    \ref{enum:prop-affine-galois-connection-closed-radical-9} 设$fg\in I(Y)$, 则由\thref{prop:affinezariskitopology}\ref{enum:prop-affine-zariski-topology-2}知$Y=(Y\cap Z(f))\cup (Y\cap Z(g))$, 因为$Y$是不可约闭集, 所以$Y\subseteq Z(f)$或者$Y\subseteq Z(g)$, 故$f\in I(Y)$或者$g\in I(Y)$.
\end{proof}

再考虑射影空间$\PP^n$的情形, 记$S\coloneq \kk [X_0, \dotsc, X_n]$, $S$的齐次多项式全体为$\Shomo$, 次数为$d$的齐次多项式全体为$S_d$, $S_+=\sum_{d>0}S_d$为$S$的一个极大理想. 对于$\Shomo$的子集$T$, 我们已经定义了$T$的零点集$Z(T)\subseteq\PP^n$. 同样地, 对于仿射空间的子集$Y$, 我们也可以定义$Y$的\emph{理想}为在$Y$上取值为零的齐次多项式全体生成的理想.

\begin{proposition}[{{\parencite[11, Exercise 2.1--2.4]{hartshorne_algebraic_1977}}}]\label{prop:projectivegaloisconnectionclosedradical}
    设$Y, Y_1, Y_2$为$\PP^n$的子集, $T, T_1, T_2$为$\Shomo$的子集, $\ideal{a}$为$S$的齐次理想, 则
    \begin{enumerate}
        \item\label{enum:prop-projective-galois-connection-closed-radical-1} $Z(T)=Z((T))=Z(\sqrt{(T)})$;
        \item\label{enum:prop-projective-galois-connection-closed-radical-2} 如果$T_1\subseteq T_2$, 那么$Z(T_1)\supseteq Z(T_2)$;
        \item\label{enum:prop-projective-galois-connection-closed-radical-3} $I(Y)=I(\overline{Y})$;
        \item\label{enum:prop-projective-galois-connection-closed-radical-4} 如果$Y_1\subseteq Y_2$, 那么$I(Y_1)\supseteq I(Y_2)$;
        \item\label{enum:prop-projective-galois-connection-closed-radical-5} $I(Y_1\cup Y_2)=I(Y_1)\cap I(Y_2)$;
        \item 下列三个条件等价.
        \begin{enumerate}
            \item $Z(\ideal{a})=\varnothing$;
            \item $\sqrt{\ideal{a}}$等于$S$或$S_+$;
            \item 对于某个$d>0$有$\ideal{a}\supseteq S_d$;
        \end{enumerate}
        \item\label{enum:prop-projective-galois-connection-closed-radical-nullstellensatz} 如果$Z(\ideal{a})\neq\varnothing$, 则$I(Z(\ideal{a}))=\sqrt{a}$;
        \item\label{enum:prop-projective-galois-connection-closed-radical-closure} $Z(I(Y))=\overline{Y}$;
        \item\label{enum:prop-projective-galois-connection-closed-radical-8} 如果$\ideal{p}$是$S$的齐次素理想且$\ideal{p}\neq S_+$, 那么$Z(\ideal{p})$是$\PP^n$的不可约闭集;
        \item\label{enum:prop-projective-galois-connection-closed-radical-9} 如果$Y$是$\PP^n$的不可约闭集, 那么$I(Y)$是$S$的素理想且$I(Y)\neq S_+$.
    \end{enumerate}
    于是由$Z$和$I$, 我们可以建立$\PP^n$的代数集全体与$S$的不同于$S_+$的齐次根理想之间的反序双射, 将$\PP^n$的不可约闭集对应到$S$的不同于$S_+$的齐次素理想. 因为$S_+$不出现在这个对应中, 有时也称$S_+$为\emph{无关极大理想}.
\end{proposition}

\begin{proof}
    只证\ref{enum:prop-projective-galois-connection-closed-radical-nullstellensatz}. 考虑$I(Z(\ideal{a}))\subseteq\ideal{a}$的情况. $\ideal{a}$也可以看成$n+1$维仿射空间$\AF^{n+1}$的多项式环$A=\kk [X_0, \dotsc, X_n]$的理想, 记$\ideal{a}$在$\AF^{n+1}$的零点集为$Y$. 考虑齐次多项式$f\in \Shomo$满足$f$在$Z(\ideal{a})\subseteq \PP^n$上均为0, 因为$Z(\ideal{a})\neq 0$且$f=0$的情况平凡, 不妨假设$f$的次数大于0, 则$f$看成$\AF^{n+1}$上的函数在$Y$上均为0, 由\thref{prop:affinegaloisconnectionclosedradical}\ref{enum:prop-affine-galois-connection-closed-radical-nullstellensatz}知$f\in\sqrt{\ideal{a}}$.
\end{proof}

% 射影空间
% 函数环的刻画
\subsection{函数环}\label{subsec:functionrings}

这一节中我们要定义仿射空间代数集的仿射坐标环, 以及射影空间中代数集的射影坐标环, 并研究它们与代数簇上的整体函数环, 在某点的局部环以及函数域的关系.

如果$Y\subseteq \AF^n$是仿射空间中的代数集, 若将$A$中元素看作为$Y$上的函数, 则$A$在由函数相等定义的等价关系下的商环即为$A(Y)\coloneq A{\divslash}I(Y)$, 称为$Y$的\emph{仿射坐标环}. 如果$Y$是仿射代数簇, 则$A(Y)$也为多项式函数整环.

现在我们可以来仔细考察仿射代数簇上定义的环与放射坐标环之间的关系, 并将代数的分式环理论\ref{subsec:algebra-localization}和维数理论\ref{subsec:algebra-dimension}应用到几何的研究中.

\begin{theorem}[{{\parencite[6, Proposition 1.7; 17, Theorem 3.2]{hartshorne_algebraic_1977}}}]\label{thm:affinerings}
    设$Y\subseteq \AF^n$为仿射代数簇, 其仿射坐标环为$A(Y)$, 则
    \begin{enumerate}
        \item\label{enum:thm-affine-rings-1} $\dim (Y)=\dim A(Y)$;
        \item\label{enum:thm-affine-rings-2} $\OO(Y)\cong A(Y)$;
        \item\label{enum:thm-affine-rings-3} 对于每个点$P\in Y$, 令$\ideal{m}_P\subseteq A(Y)$为在$P$点取值为零的坐标函数全体所构成的极大理想, 则$P\mapsto \ideal{m}_P$给出了$Y$到$A(Y)$的极大理想全体之间的双射;
        \item\label{enum:thm-affine-rings-4} 对于每个点$P$, 都有$\OO_P\cong A(Y)_{\ideal{m}_P}$, 并且$\dim \OO_P=\dim Y$;
        \item\label{enum:thm-affine-rings-5} $K(Y)$同构于$A(Y)$的分式域, 于是$K(Y)$是$\kk$的有限域扩张, 超越次数等于$\dim (Y)$.
    \end{enumerate}
\end{theorem}

\begin{proof}
    根据\thref{prop:affinegaloisconnectionclosedradical}知$Y$的不可约闭子集全体到$A$的包含$I(Y)$的素理想全体之间有反序双射, 故由\thref{prop:quotidealcorr}知到$A(Y)$的素理想全体之间也有反序双射. 因此$Y$的不可约闭子集降链与$A(Y)$的素理想升链之间有保长度的双射, 于是由\thref{thm:ringdim}知$\dim (Y)=\dim (A(Y))$, \ref{enum:thm-affine-rings-1}得证.

    因为每个$A$的元素都能看成$Y$上的正规函数, 于是有同态$A\to \OO (Y)$, 又这个同态的核恰为$I(Y)$, 于是我们有单同态$\alpha\colon A(Y)\to \OO (Y)$.

    利用\thref{prop:quotidealcorr}我们知道$Y$与$A$中包含$I(Y)$的极大理想全体之间存在双射, 即与$A(Y)$的极大理想全体之间存在一一对应. 利用上述定义的$\alpha$将$A(Y)$的元素看作$Y$上的正规函数, 我们有点$P$对应的极大理想即为$\ideal{m}_{P}=\{f\in A(Y)\vert f(P)=0\}$, 故\ref{enum:thm-affine-rings-3}得证.

    对于每个$P\in Y$, 将$\OO (Y)$看作$\OO_P$的子环, 我们可以得到单同态$A(Y)\to \OO_P$, 这个同态将每个$\ideal{m}_P$外的元素都映到单位, 于是我们可以得到单同态$A(Y)_{\ideal{m}_{P}}\to \OO_P$. 根据正规函数的定义, 正规函数在局部上可以写成两个多项式的商, 其中分母在局部没有零点, 于是有这个同态也是满射, 因此$A(Y)_{\ideal{m}_P}\cong \OO_P$. 因为$\OO_P$是整环, 对$\ideal{p}=(0)\subseteq \OO_P$利用\thref{thm:ringdim}和\thref{prop:fracideal}\ref{enum:prop-fracideal-2}可得$\dim \OO_P$等于极大理想$\ideal{m}_P$在$A(Y)$的高度$h(\ideal{m}_P)$. 又因为$A(Y){\divslash}\ideal{m}_P\cong \kk$, 即$\codim (\ideal{m}_P)=0$, 故利用\ref{enum:thm-affine-rings-1}和\thref{thm:ringdim}知$h(\ideal{m}_P)=\dim A(Y)=\dim (Y)$, 于是$\dim (\OO_P)=\dim (Y)$, \ref{enum:thm-affine-rings-4}得证.

    根据\ref{enum:thm-affine-rings-3}和\thref{prop:multilocalization}, 对于每个$P\in Y$都有分式域$K(A(Y))\cong K(A(Y)_{\ideal{m}_P})\cong K(\OO_P)$. 因为典范单同态$\OO_P\to K(Y)$诱导出的映射$\amalg_{P\in Y}\OO_P\to K(Y)$是满射, 即每个有理函数都能看成某个$\OO_Y$中的元素, 因此对于每个$P$都有$K(\OO_P)\cong K(Y)$, 故$K(A(Y))\cong K(Y)$. 因为$A(Y)$是有限生成$\kk$-代数, 所以$K(Y)\cong K(A(Y))$是$\kk$的有限域扩张, 并且根据域的多项式函数整环维数的定义, 有$\dim (Y)$即为域扩张的超越次数, \ref{enum:thm-affine-rings-5}得证.

    最后, 利用\ref{enum:thm-affine-rings-3}和\ref{enum:thm-affine-rings-4}, 并将每个环都看成分式域$K(Y)$的子环, 我们有$A(Y)\subseteq\OO (Y)\subseteq \bigcap_{\ideal{m}} A(Y)_{\ideal{m}}$. 而\thref{prop:integraldomainlocalizationintersection}证明了$\bigcap_{\ideal{m}} A(Y)_{\ideal{m}}= A(Y)$, 因此我们有$A(Y)\cong \OO(Y)$, 这证明了\ref{enum:thm-affine-rings-2}.
\end{proof}

与仿射情形类似, 如果$Y\subseteq \PP^n$是射影空间中的代数集, 定义$Y$的\emph{射影坐标环}$S(Y)\coloneq S{\divslash}I(Y)$.

\begin{theorem}[{{\parencite[11--12, Exercise 2.6; 18, Theorem 3.4]{hartshorne_algebraic_1977}}}]\label{thm:projectiverings}
    设$Y\subseteq\PP^n$为射影代数簇, 其齐次射影坐标环为$S(Y)$, 则
    \begin{enumerate}
        \item\label{enum:thm-projective-rings-1} $\dim (S(Y))=\dim (Y)+1$;
        \item\label{enum:thm-projective-rings-2} $\OO (Y)\cong\kk$;
        \item\label{enum:thm-projective-rings-3} 对于每个点$P\in Y$, 令$\ideal{m}_P\subseteq S(Y)$为在$P$点取值为零的齐次坐标函数所生成的极大理想, 则$\OO_P\cong S(Y)_{(\ideal{m}_P)}$;
        \item\label{enum:thm-projective-rings-4} $K(Y)\cong S(Y)_{(0)}$.
    \end{enumerate}
\end{theorem}

\begin{proof}
    首先, 设$U_j\subseteq\PP^n$是由$X_j\neq 0$所定义的开集, 记$Y_j=Y\cap U_j$, 则由\thref{prop:projectiveopencoverisomorphism}知$\varphi_j$诱导出$Y_j$与$\AF^n$的某个仿射代数簇的同构. 有$S(Y)_{X_j}$同构于$A(Y_j)[X_j, X_j^{-1}]$, 通过计算域扩张的次数以及利用\thref{thm:affinerings}\ref{enum:thm-affine-rings-1}, 有$\dim (S(Y))=\dim (S(Y)_{X_j})=\dim (A(Y_j)[X_j, X_j^{-1}])=\dim (A(Y))+1=\dim (Y)+1$. 这证明了\ref{enum:thm-projective-rings-1}.

    我们现在来构造仿射坐标环$A(Y_j)$与$S(Y)_{(X_j)}$之间的同构. 首先如\thref{prop:projspaceopencoverhomeo}中那样构造$\kk [Y_1, \dotsc, Y_n]$到$\kk [X_0, \dotsc, X_n]_{(X_j)}$的同构, 将$f$映到$f(X_0{\divslash}X_j, \dotsc, X_{j-1}{\divslash}X_j, X_{j+1}{\divslash}X_j, \dotsc, X_n{\divslash}X_j)$. 通过验证多项式的零点可以证明这个同构将$I(Y_j)$映到$I(Y)S_{(X_j)}$, 于是我们得到了同构$\varphi_j^*\colon A(Y_j)\cong S(Y)_{(X_j)}$.

    设$P\in Y$为任意点, 存在$j$使得$P\in Y_j$, 记$\ideal{m}_P'$为$P$在$A(Y_j)$中对应的极大理想. 由\thref{thm:affinerings}\ref{enum:thm-affine-rings-4}可得$\OO_P\cong A(Y_j)_{\ideal{m}_P'}$. 通过验证多项式的零点可以证明$\varphi_{j}^*(\ideal{m}_P')=\ideal{m}_PS(Y)_{(X_j)}$. 因为$X_j\notin \ideal{m}_P$, 再根据\thref{prop:multilocalization}可得$A(Y_j)_{\ideal{m}_P'}\cong S(Y)_{\ideal{m}_P}$. 这证明了\ref{enum:thm-projective-rings-3}.

    类似地, 由\thref{thm:affinerings}\ref{enum:thm-affine-rings-5}可得$K(Y)\cong K(Y_j)$同构于$A(Y_j)$的分式域, 再由$\varphi_j^*$得同构于$S(Y)_{(0)}$. 这证明了\ref{enum:thm-projective-rings-4}.

    最后, 设$f\in\OO (Y)$是整体的正规函数, 于是对于每个$j$都有$f$在$Y_j$上正规, 于是根据\thref{thm:affinerings}\ref{enum:thm-affine-rings-2}可以认为$f\in A(Y_j)$, 又由$\varphi_j^*$知$A(Y_j)\cong S(Y)_{(X_j)}$, 于是$f$可以写成$g_j{\divslash}X_j^{N_j}$的形式, 其中$g_j\in S(Y)$为$N_j$次的齐次多项式. 因为$S(Y)$是整环, 所以可以将$\OO (Y), K(Y), S(Y)$都看作$S(Y)$的分式域$L$的子环, 于是$X_j^{N_j}f\in S(Y)_{N_j}$, 其中$S(Y)_{N_j}$表示齐次环$S(Y)$中次数为$N_j$的齐次元全体. 取$N\geq \sum N_j$, 则$S(Y)_N$作为$\kk$-线性空间可以由次数为$N$的由$X_0, \dotsc, X_n$构成的单项式生成, 根据鸽笼原理知$f\cdot S(Y)_N\subseteq S(Y)_N$, 迭代即得对于每个$q>0$都有$f^q\cdot S(Y)_N$. 特别地, 取$X_j\notin I(Y)$, 则有对于每个$q>0$都有$X_0^Nf^q\in S(Y)$. 于是子环$S(Y)[f]\subseteq L$包含于$X_0^{-N}S(Y)$中, 而$X_0^{-N}S(Y)$是有限生成$S(Y)$-模. 因为$S(Y)$是Noether环, 所以$S(Y)[f]$是有限生成$S(Y)$-模, 于是由\thref{prop:integraldependence}知$f$为$S(Y)$的整元, 又因为$f$的次数为零, 故存在$x_1, \dotsc, x_m\in S(Y)\cong \kk$使得$f^m+x_1f^{m-1}+\dotsb +x_m=0$成立. 于是$f$是$\kk$的代数元, 又$\kk$是代数闭域, 于是有$f\in \kk$, 这证明了\ref{enum:thm-projective-rings-1}.
\end{proof}% TODO: Noether module 诺特环的有限生成模是诺特模 诺特模的子模是有限生成的

\begin{theorem}{{\parencite[19, Proposition 3.5]{hartshorne_algebraic_1977}}}\label{thm:categoryisoaffinevariety}
    设$X$是任意的代数簇, $Y$是仿射代数簇, 则存在双射
    \begin{equation*}
        \alpha\colon \Hom (X, Y)\to\Hom (A(Y), \OO (X)).
    \end{equation*}
    并且下图中定义的函子
    \begin{equation*}
        \begin{tikzcd}
            X \arrow[r, mapsto] \arrow[d, "\varphi"] & A(X) \arrow[d, "\alpha (\varphi)"]\\
            Y \arrow[r, mapsto] & A(Y)
        \end{tikzcd}
    \end{equation*}
    给出了$k$的代数簇范畴与$k$的多项式函数整环范畴(态射为$\kk$-代数同态)的范畴等价.
\end{theorem}

\begin{proof}
    \thref{prop:morphismtoaffinevariety}
    \thref{thm:categoryequivalence}
\end{proof}

% dominant rational map 有限生成k代数

\subsection{杂项}

% 交理论 准素分解 维数理论
% Zariski Vol I P241 Theorem 30, 31
% AM P69 Exercise 5.16
% Hartshorne Ex 2.6

\subsection{仿射概型}

% 极大谱和仿射空间同胚 更一般地 我们有\thref{thm:affinerings}
% 准素分解 孤立 嵌入

\subsection{代数群与Hopf代数}

% Hartshorne Ex 3.21 Group Variety (Algebraic Group)
% Basic examples
% affine algebraic groups
% Hopf algebra
