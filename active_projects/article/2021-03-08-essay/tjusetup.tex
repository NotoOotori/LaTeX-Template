% !TeX root = ./main.tex

% 论文基本信息配置

\tjusetup{
  %******************************
  % 注意：
  %   1. 配置里面不要出现空行
  %   2. 不需要的配置信息可以删除
  %   3. 建议先阅读文档中所有关于选项的说明
  %******************************
  %
  % 输出格式
  %   选择打印版（print）或用于提交的电子版（electronic），前者会插入空白页以便直接双面打印
  %
  % output = print,
  %
  % 标题
  %   不可使用“\\”命令手动控制换行
  %   副标题为可选项
  %
  title  = {代数理论的几何应用},
  % subtitle = {使用示例文档 v\version},
  title* = {Application of Algebra to Geometry},
  %
  % 学位
  %   1. 学术型
  %      - 中文
  %        需注明所属的学科门类，例如：
  %        哲学、经济学、法学、教育学、文学、历史学、理学、工学、农学、医学、
  %        军事学、管理学、艺术学
  %      - 英文
  %        博士：Doctor of Philosophy
  %        硕士：
  %          哲学、文学、历史学、法学、教育学、艺术学门类，公共管理学科
  %          填写“Master of Arts“，其它填写“Master of Science”
  %   2. 专业型
  %      直接填写专业学位的名称，例如：
  %      教育博士、工程硕士等
  %      Doctor of Education, Master of Engineering
  %   3. 本科生不需要填写
  %
  % degree-name  = {工学硕士},
  % degree-name* = {Master of Science},
  %
  % 培养单位
  %   填写所属院系的全名
  %
  department = {数学科学学院},
  %
  % 学科
  %   1. 学术型学位
  %      获得一级学科授权的学科填写一级学科名称，其他填写二级学科名称
  %   2. 工程硕士
  %      工程领域名称
  %   3. 其他专业型学位
  %      不填写此项
  %   4. 本科生填写专业名称，第二学位论文需标注“（第二学位）”
  %
  discipline  = {数学与应用数学},
  % discipline* = {Computer Science and Technology},
  %
  % 姓名
  %
  author  = {陈旭阳},
  % author* = {Xue Ruini},
  %
  % 学号
  %
  id = {1753763},
  %
  % 指导教师
  %   中文姓名和职称之间以英文逗号“,”分开，下同
  %
  supervisor  = {李灵光, 副教授},
  % supervisor* = {Professor Zheng Weimin},
  %
  % 日期
  %   使用 ISO 格式；默认为当前时间
  %
  % date = {2019-07-07},
}

%% Put any packages you would like to use here

% 表格中支持跨行
% \usepackage{multirow}

% 跨页表格
% \usepackage{longtable}

% 固定宽度的表格。放在 hyperref 之前的话，tabularx 里的 footnote 显示不出来。
% \usepackage{tabularx}

% 表格加脚注
% \usepackage{threeparttable}
% \pretocmd{\TPTnoteSettings}{\footnotesize}{}{}

% 确定浮动对象的位置，可以使用 H，强制将浮动对象放到这里（可能效果很差）
% \usepackage{float}

% 浮动图形控制宏包。
% 允许上一个 section 的浮动图形出现在下一个 section 的开始部分
% 该宏包提供处理浮动对象的 \FloatBarrier 命令，使所有未处
% 理的浮动图形立即被处理。这三个宏包仅供参考，未必使用：
% \usepackage[below]{placeins}
% \usepackage{floatflt} % 图文混排用宏包
% \usepackage{rotating} % 图形和表格的控制旋转

% 定理类环境宏包
% \usepackage{amsthm}
% 也可以使用 ntheorem
\usepackage[amsmath,thmmarks,hyperref,thref]{ntheorem}
\numberwithin{equation}{subsection}
\makeatletter
  \renewcommand\c@equation\c@theorem
\makeatother

% One should always load \usepackage{hyperref} before the first use of \newtheorem to obtain correct handling and referencing of counters.
\AtBeginDocument{
  \theoremstyle{plain}
  \theoremheaderfont{\bfseries}\theorembodyfont{\upshape}
  \theoremindent0pt
  % \theoremprework{}
  \newtheorem{theorem}{定理}[subsection]
  \newtheorem{corollary}[theorem]{推论}
  \newtheorem{lemma}[theorem]{引理}
  \newtheorem{proposition}[theorem]{命题}
  \theoremsymbol{\ensuremath{\mdlgwhtsquare}}
  \newtheorem{theoremnoproof}[theorem]{定理}
  \newtheorem{propositionnoproof}[theorem]{命题}
  \theoremsymbol{}
  % \newtheorem{axiom}[theorem]{公理}
  % \newtheorem{conjection}[theorem]{猜想}
  \newtheorem{definition}[theorem]{定义}
  \newtheorem{remark}[theorem]{注}
  \newtheorem{example}[theorem]{例}
  \theoremstyle{nonumberplain}
  \theoremheaderfont{\bfseries}\theorembodyfont{\upshape}
  \theoremindent0pt
  % \theoremsymbol{\ensuremath{\enclosesquare}}
  \theoremsymbol{\ensuremath{\mdlgwhtsquare}}
  \newtheorem{proof}{证明}
  \newtheorem{proofhint}{证明思路}
  \theoremsymbol{}
  % \newtheorem{proofsketch}{证明梗概}
  % \newenvironment{breakexample}{\begin{example}\leavevmode\vspace{-\baselineskip}}{\end{example}}
  % TODO: theorem style

  % \makeatletter
  % \newcommand{\ntheoremheader}[1]{\expandafter\csname mkheader@#1\endcsname}
  % \makeatother

  % \appto\appendix{%
  %   \theoremstyle{plain}%
  %   \theoremheaderfont{\bfseries}%
  %   \theorembodyfont{\upshape}%
  %   \theoremindent0pt%
  %   \renewtheorem{theorem}{定理}[section]%
  % }% etoolbox
}

% 给自定义的宏后面自动加空白
% \usepackage{xspace}

% 定义所有的图片文件在 figures 子目录下
% \graphicspath{{figures/}}

% 配置enumitem宏包
\setlist*[enumerate,1]{left = \parindent .. 2\parindent} % 设置enumerate环境一级分项的缩进, 用star version以添加设置而不是覆盖之前的设置

% tikz-cd
\usepackage{tikz-cd}
\tikzcdset{
  arrow style=tikz,
  diagrams={>={Straight Barb[scale=0.8]}}
}% from documentation
% \newcommand{\tikzcdarrowdimens}[2]{%
%     \tikzcdset{every arrow/.append style={line width=#1}}%
%     \pgfmathdeclarefunction*{axis_height}{0}{%
%         \begingroup%
%         \pgfmathreturn#2%
%         \endgroup%
%     }%
% }
% \tikzcdarrowdimens{0.068em}{0.259em}% https://tex.stackexchange.com/a/423314

% 定义自己常用的东西
% \def\myname{薛瑞尼}

% 数学命令
% unicode-math does many jobs at begin document, so we need to declare operator after that.
\AtBeginDocument{%https://tex.stackexchange.com/a/117995
  \DeclareMathOperator{\Aut}{Aut}
  \DeclareMathOperator{\Ann}{Ann}
  \let\dim\relax
  \DeclareMathOperator{\dim}{dim}
  \DeclareMathOperator{\codim}{codim}
  \let\det\relax
  \DeclareMathOperator{\det}{det}
  \let\Im\relax
  \DeclareMathOperator{\Ker}{Ker}
  \DeclareMathOperator{\Im}{Im}
  \let\max\relax
  \DeclareMathOperator{\max}{max}
  \let\min\relax
  \DeclareMathOperator{\min}{min}
  \ifdefined\Hom\let\Hom\relax\fi
  \DeclareMathOperator{\Hom}{Hom}
  \DeclareMathOperator{\Spec}{Spec}
  \DeclareMathOperator{\MaxSpec}{MaxSpec}
  \DeclareMathOperator{\ob}{ob}
  %https://tex.stackexchange.com/questions/175251/how-to-redefine-a-command-using-declaremathoperator
}

\newcommand*{\lr}[3]{\left#1#3\right#2}
\newcommand*{\lrbig}[3]{\big#1#3\big#2}
\newcommand*{\ideal}[1]{\symfrak{#1}}
% \newcommand*{\rad}[1]{\sqrt{\ideal{#1}}}
\newcommand*{\axiom}[1]{\ensuremath{\symsfup{#1}}}
\newcommand*{\field}[1]{#1}
\newcommand*{\cat}[1]{\symbfup{#1}}% Category
\newcommand*{\powerset}[1]{2^{#1}}

\newcommand*{\CC}{\symbb{C}}
\newcommand*{\ZZ}{\symbb{Z}}
\newcommand*{\NN}{\symbb{N}}
\newcommand*{\RR}{\symbb{R}}
\newcommand*{\AF}{\symbb{A}}
\newcommand*{\PP}{\symbb{P}}
\newcommand*{\kk}{\field{k}}
\newcommand*{\nil}{\symfrak{N}}
\newcommand*{\OO}{\symcal{O}}
\newcommand*{\algebra}{\cat{Algr}}
\newcommand*{\variety}{\cat{Var}}
\newcommand*{\composite}{\vysmwhtcircle}
\newcommand*{\op}{\symup{op}}
\newcommand*{\Cone}{\symup{Cone}}
% \newcommand*{\mapsfrom}{\mathrel{\reflectbox{\ensuremath{\mapsto}}}}% defined by unicode-math
% \newcommand*{\niton}{\mathrel{\reflectbox{\ensuremath{\notin}}}}
\newcommand*{\depend}{\prec}
\newcommand*{\ndepend}{\nprec}
\newcommand*{\SAa}{\overline{S}^{-1}(A{\divslash}\ideal{a})}
\newcommand*{\SASa}{S^{-1}A{\divslash}S^{-1}\ideal{a}}
\newcommand*{\Shomo}{S^h}

%% functor diagram
\makeatletter
\newcommand*{\@covariantfunctordiagramwithoutcategory}[6]{%
  #1 \arrow[dd, "#3"{left}] \& \mapsto \& |[alias=X]| #4\\
  \& \mapsto \& \\
  #2 \& \mapsto \& |[alias=Y]| #5
  \arrow[from=X, to=Y, "#6"{right}]
}
\newcommand*{\@contravariantfunctordiagramwithoutcategory}[6]{%
  #1 \arrow[dd, "#3"{left}] \& \mapsto \& |[alias=X]| #4\\
  \& \mapsto \& \\
  #2 \& \mapsto \& |[alias=Y]| #5
  \arrow[from=Y, to=X, "#6"{right}]
}
\newcommand*{\@functordiagramwithoutcategory}{% X Y f F(X) F(Y) F(f)
  \@ifstar{\@contravariantfunctordiagramwithoutcategory}{\@covariantfunctordiagramwithoutcategory}%
}
\newcommand*{\functordiagramwithoutcategory}{% X Y f F(X) F(Y) F(f)
  \begin{tikzcd}[sep=small, ampersand replacement=\&]
    \@ifstar{\@functordiagramwithoutcategory*}{\@functordiagramwithoutcategory}%
  \end{tikzcd}
}
\newcommand*{\@functordiagram@nostar}[9]{%
  \begin{tikzcd}[sep=small, ampersand replacement=\&]
    #1 \arrow{rr}{#3} \& \& #2\\
    \@functordiagramwithoutcategory{#4}{#5}{#6}{#7}{#8}{#9}%
  \end{tikzcd}%
}
\newcommand*{\@functordiagram@star}[9]{%
  \begin{tikzcd}[sep=small, ampersand replacement=\&]
    #1 \arrow{rr}{#3} \& \& #2\\
    \@functordiagramwithoutcategory*{#4}{#5}{#6}{#7}{#8}{#9}
  \end{tikzcd}%
}
\newcommand*{\functordiagram}{% C D F X Y f F(X) F(Y) F(f)
  \@ifstar{\@functordiagram@star}{\@functordiagram@nostar}%
}
\makeatother

% enumerate中的公式
\makeatletter%
\appto{\equation}{%
    \hspace*{-\@totalleftmargin}%
}
\makeatother%

% 借用 ltxdoc 里面的几个命令方便写文档。
% \DeclareRobustCommand\cs[1]{\texttt{\char`\\#1}}
% \providecommand\pkg[1]{{\sffamily#1}}

% 借用 lipsum与zhlipsum 来填充内容
\usepackage{lipsum}
\usepackage{zhlipsum}

% 交叉引用
\usepackage{varioref}
\labelformat{section}{\S#1}
\labelformat{subsection}{\S#1}

\makeatletter
\newif\if@appendix
\appto\appendix{\@appendixtrue}
\appto\backmatter{\@appendixfalse}
\preto\section{\if@appendix\else\clearpage\fi}
\makeatother
