% -------------------- Packages --------------------

\documentclass[lineno]{assignment}

% -------------------- Settings --------------------

% Title

\title{Homework of Chapter 2}
\author{Chen Xuyang}
\date{\today}
\institute{School of Mathematical Science}
\professor{Chen Xiongda}
\course{Operations Research}
\subject{Operations Research}
\keywords{}

% -------------------- New commands --------------------

\newcommand{\BR}{\symbb{R}}
\theoremstyle{plain}
\theoremheaderfont{\upshape\bfseries}
\theorembodyfont{\upshape}
\theoremsymbol{}
\newtheorem{lemma}{Lemma}

% -------------------- Document --------------------

\begin{document}
    \maketitle

    \begin{problem}
        Compute the gradient $\nabla f(x)$ and Hessian $\nabla^{2}f(x)$ of the Rosenbrock function
        \begin{equation}
            f(x)=100(x_{2}-x_{1}^{2})^{2}+(1-x_{1})^{2}.
        \end{equation}
        Show that $x^{*}=(1,1)^{T}$ is the only local minimizer of this function, and that the Hessian matrix at that point is positive definite.
    \end{problem}
    \begin{solution}
        Calculate the gradient and Hessian of $f$, we have
        \begin{equation}
            \nabla f =
            \begin{bmatrix}
                400x_1^3+2x_1-400x_1x_2-2\\
                -200x_1^2+200x_2
            \end{bmatrix},
        \end{equation}
        and
        \begin{equation}
            \nabla^{2}f(x) =
            \begin{bmatrix}
                1200x_1^2-400x_2+2 & -400x_1\\
                -400x_1 & 200
            \end{bmatrix}.
        \end{equation}
        It's obvious that $\nabla f(x)=0$ if and only if $x=(1,1)^{T}$, and
        \begin{equation}
            \nabla^{2}f(1, 1) =
            \begin{bmatrix}
                802 & -400\\
                -400 & 200
            \end{bmatrix}
        \end{equation}
        is positive definite by testing Sylvester's criterion.
    \end{solution}
    \begin{problem}
        Show that the function $f(x)=8x_1+12x_2+x_1^2-2x_2^2$ has only one stationary point, and that it is neither a maximum or minimum, but a saddle point. Sketch the contour lines of $f$.
    \end{problem}
    \begin{solution}
        Calculate the gradient of $f$
        \begin{equation}
            \nabla f =
            \begin{bmatrix}
                2x_1+8\\
                -4x_2+12
            \end{bmatrix}.
        \end{equation}
        Then we can find out $f$ has only one stationary point, that is $(-4, 3)^T$. At that point, the Hessian
        \begin{equation}
            \nabla^{2}f =
            \begin{bmatrix}
                2 & 0\\
                0 & -4
            \end{bmatrix}
        \end{equation}
        is indefinite. Hence it is a saddle point.
        \begin{figure}[H]
            \centering
            \input{resources/2-contour.tex}
            \caption{Contour lines of $f$}
        \end{figure}
        Here is the contour lines of $f$, where we can see that $(-4, 3)^T$ is neither minimal nor maximal of $f$.
    \end{solution}
    \begin{problem}
        Let $a$ be a given $n$-vector, and $\matr{A}$ be a given $n\times n$ symmetric matrix. Compute the gradient and Hessian of $f_1(x)=a^Tx$ and $f_2(x)=x^T\matr{A}x$.
    \end{problem}
    \begin{solution}
        From calculation, we can obtain that
        \begin{equation}
            \begin{aligned}
                \nabla f_1 &= a\\
                \nabla f_2 &= 2\matr{A}x,
            \end{aligned}
        \end{equation}
        and
        \begin{equation}
            \begin{aligned}
                \nabla^2 f_1 &= 0\\
                \nabla^2 f_2 &= 2\matr{A},
            \end{aligned}
        \end{equation}
        which is all we need.
    \end{solution}
    \begin{problem}
        Write the second-order Taylor expansion (2.6) for the function $\cos(1/x)$ around a nonzero point $x$, and the third-order Taylor expansion of $\cos(x)$ around any point $x$. Evaluate the second expansion for the specific case of $x=1$.
    \end{problem}
    \begin{solution}
        Suppose $x>0$, then
        \begin{equation}
            \cos\left(\frac{1}{x+p}\right)=\cos\left(\frac{1}{x}\right)+\frac{1}{x^2}\sin\left(\frac{1}{x}\right)p+\frac{1}{2}\left(-\frac{2}{\xi^3}\sin\left(\frac{1}{\xi}\right)-\frac{1}{\xi^4}\cos\left(\frac{1}{\xi}\right)\right)p^2,
        \end{equation}
        where $\xi = x + \theta p$ and $\theta \in (0, 1)$. For the second expansion,
        \begin{equation}
            \cos(x+p)=\cos(x)-\sin(x)p-\frac{1}{2}\cos(x)p^2+\frac{1}{6}\sin(x+\theta p)p^3,
        \end{equation}
        where $\theta \in (0, 1)$. For the special case $x=1$,
        \begin{equation}
            \cos(1+p)=\cos(1)-\sin(1)p-\frac{1}{2}\cos(1)p^2+\frac{1}{6}\sin(1+\theta p)p^3,
        \end{equation}
        where $\theta \in (0, 1)$.
    \end{solution}
    \begin{problem}
        Consider the function $f:\BR^2\to\BR$ defined by $f(x)=\norm{x}^2$. Show that the sequence of iterates $\{x_k\}$ defined by
        \begin{equation}
            x_k = \left(1+\frac{1}{2^k}\right)
            \begin{bmatrix}
                \cos(k)\\
                \sin(k)
            \end{bmatrix}
        \end{equation}
        satisfies $f(x_{k+1})<f(x_k)$ for $k=0, 1, 2, \dotsc$. Show that every point on the unit circle $\{x :\ \norm{x}^2=1\}$ is a limit point for $\{x_k\}$.
    \end{problem}
    \begin{proof}
        For the first part, the function of $k$
        \begin{equation}
            f(x_k) = \left(1+\frac{1}{2^k}\right)^2
        \end{equation}
        is obviously strictly decreasing. Hence $f(x_{k+1})<f(x_k)$ for $k=0, 1, 2, \dotsc$.

        For the second part, we shall first notice the fact that $n \bmod 2\pi$ is dense in $[0, 2\pi]$, which we isolate in a lemma below. Therefore both $\cos(k)$ and $\sin(k)$ are dense in $[0, 1]$. For $x \in \BR^2$, let $\theta(x)$ denote the argument of $x$, whose range is $[0, 2\pi)$. Then for each $x$ on the unit circle, there is some subsequence of $\{x_k\}$ still denoted by $\{x_k\}$ such that $\rho(x_k)\to\rho(x)$ as $k\to\infty$. Since we also have $f(x_k)\to f(x)$ as $k\to\infty$, by convergence in polar coordinate system, we can obtain that $\{x_k\} \to x$, that is to say, $x$ is a limit point of $\{x_k\}$. It follows the conclusion.
    \end{proof}
    \begin{lemma}
        Let $x$ be an irrational number and $\{\cdot\}$ be the \textit{fraction part}. Then the set $\left\{\{nx\}:n\in\symbb{N}\right\}$ is dense in $[0, 1]$. Specifically, the set $\left\{\{n/(2\pi)\}: n\in\symbb{N}\right\}$ is dense in $[0, 1]$, which is equivalent to the statement that the set $\{n\bmod 2\pi:n\in\symbb{N}\}$ is dense in $[0, 2\pi]$.
    \end{lemma}
    \begin{proof}
        First we shall notice that $0\notin\left\{\{nx\}:n\in\symbb{N}\right\}$ since $x$ is not a rational number, which will be useful in the following proof. Let's then focus on the statement that `for every $\varepsilon>0$, there is some $n\in\symbb{N}$ such that $\{nx\}<\epsilon$'.
        
        Suppose not. Then there exists some positive number $\delta$ such that
        \begin{equation}
            \inf \left\{\{nx\}:n\in\symbb{N}\right\}=\delta<1.
        \end{equation}
        By Archimedean property, we can find such integer $m$ that
        \begin{equation}
            \delta m\geq 1,\quad\text{while}\ \delta(m-1)<1.
        \end{equation}
        Then we have $1\leq m\delta<1+\delta$. By definition of infinum, for every $0<\varepsilon<1+\delta-m\delta$, there exists some $k\in N$ such that $0\leq\{kx\}-\delta<\varepsilon/m$. Hence
        \begin{equation}
            1\leq m\delta \leq m\{kx\}<m\delta+\varepsilon<1+\delta<2.
        \end{equation}
        Take $\{\cdot\}$ in the inequalities, then we have
        \begin{equation}
            0\leq \left\{m\{kx\}\right\} = \{mkx\}<\delta,
        \end{equation}
        which leads to a contradiction.

        For every $0<a<b<1$, we know there exists some $m\in\symbb{N}$ such that $0<\{mx\}<b-a$. Now let $k$ be the smallest integer such that $k\{mx\}>a$, then we have $0<a<k\{mx\}<b<1$. It follows that $\left\{\{nx\}:n\in\symbb{N}\right\}$ is dense in $[0, 1]$.
    \end{proof}
    \begin{problem}
        Prove that all isolated local minimizers are strict.
    \end{problem}
    \begin{proof}
        Let $f$ denote the target function. Assume $x_0$ is an isolated local minimizer but not strict. By definition and Axiom of Countable Choice, there exists an sequence $\{x_k\}_1^\infty$ converging to $x_0$ such that $f(x_k)=f(x_0)$ for all $k>0$. Since $x_0$ is an isolated local minimizer, there exists a neighbourhood $N(x_0)$ such that $f(x_0)\leq f(x)$ for all $x\in N(x_0)$. By definition of converge, there exists some integer $M$ such that $x_k\in N(x_0)$ for all $k\geq M$. Then there is some neighbourhood $N(x_k)\subseteq N(x_0)$ where $f(x_k)=f(x_0)\leq f(x)$ for all $x\in N(x_k)$. It follows that $\{x_k\}_M^\infty$ is a sequence of local minimizers which converges to $x_0$, which leads to a controversy.
    \end{proof}
    \begin{problem}
        Suppose that $f(x)=x^T\matr{Q}x$, where $\matr{Q}$ is an $n\times n$ symmetric positive semidefinite matrix. Show using the definition (1.4) that $f(x)$ is convex on the domain $\BR^n$.
    \end{problem}
    \begin{proof}
        Let $\alpha \in (0, 1)$, then
        \begin{equation}
            \begin{aligned}
                &\phantom{{}={}} f(y+\alpha(x-y))-\alpha f(x)-(1-\alpha)f(y)\\
                &= (y+\alpha(x-y))^T\matr{Q}(y+\alpha(x-y))-\alpha x^T\matr{Q}x-(1-\alpha)y^T\matr{Q}y\\
                &= 2\alpha y^T\matr{Q}(x-y)+\alpha y^T\matr{Q}y-\alpha x^T\matr{Q}x+\alpha^2(x-y)^T\matr{Q}(x-y)\\
                &= -\alpha(x-y)^T\matr{Q}(x-y)+\alpha^2(x-y)^T\matr{Q}(x-y).
            \end{aligned}
        \end{equation}
        Because $\matr{Q}$ is positive semi-definite and $\alpha \in (0, 1)$, $f(y+\alpha(x-y))-\alpha f(x)-(1-\alpha)f(y) \leq 0$. It follows that $f$ is convex on $\BR^n$.
    \end{proof}
    \begin{problem}
        Show that the sequence $x_k=1/k$ is not Q-linearly convergent, though it does converge to zero. (This is called \textit{sublinear convergence}.)
    \end{problem}
    \begin{proof}
        Since
        \begin{equation}
            \frac{x_{k+1}-x^{*}}{x_k-x^{*}} = \frac{k}{k+1} \to 1
        \end{equation}
        as $k \to \infty$, there isn't an constant $r\in(0, 1)$ such that
        \begin{equation}
            \frac{x_{k+1}-x^{*}}{x_k-x^{*}} < r
        \end{equation}
        for all $k$ sufficiently large. It follows that the sequence $x_k=1/k$ is not Q-linearly convergent.
    \end{proof}
\end{document}
